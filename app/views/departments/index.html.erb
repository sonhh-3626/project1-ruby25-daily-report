<h1 class="mb-4"><%= t "departments.index.title" %></h1>

<div class="row mb-4 align-items-end">
  <div class="col-md-10">
    <%= form_with url: departments_path, method: :get, local: true do |f| %>
      <%= f.text_field :query, value: params[:query], placeholder: t("departments.index.search_placeholder"), class: "form-control" %>
    <% end %>
  </div>
  <div class="col-md-2 text-md-end mt-2 mt-md-0">
    <%= link_to new_department_path, class: "btn btn-success" do %>
      <i class="fas fa-plus"></i> <%= t("departments.index.add_button") %>
    <% end %>
  </div>
</div>

<% if @departments.any? %>
  <table class="table table-striped">
    <thead>
      <tr>
        <th><%= t("departments.index.table.name") %></th>
        <th><%= t("departments.index.table.description") %></th>
        <th><%= t("departments.index.table.staff_count") %></th>
        <th><%= t("departments.index.table.created_at") %></th>
        <th><%= t("departments.index.table.updated_at") %></th>
        <th><%= t("departments.index.table.actions") %></th>
      </tr>
    </thead>
    <tbody>
      <% @departments.each do |department| %>
        <tr>
          <td><%= department.name %></td>
          <td><%= department.description %></td>
          <td><%= department.users.count %></td>
          <td><%= department.created_at.strftime("%d-%m-%Y") %></td>
          <td><%= department.updated_at.strftime("%d-%m-%Y") %></td>
          <td class="d-flex gap-1">
            <%= link_to department_path(department), class: "btn btn-sm btn-outline-primary", title: t("departments.index.show") do %>
              <i class="fas fa-eye"></i>
            <% end %>
            <%= link_to edit_department_path(department), class: "btn btn-sm btn-outline-warning", title: t("departments.index.edit") do %>
              <i class="fas fa-edit"></i>
            <% end %>
            <%= link_to department, data: { "turbo-method": :delete, "turbo-confirm": t("departments.index.confirm_delete") }, class: "btn btn-sm btn-outline-danger", title: t("departments.index.delete") do %>
              <i class="fas fa-trash-alt"></i>
            <% end %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
  <div class="d-flex text-center mt-4">
    <%== pagy_bootstrap_nav(@pagy) if @pagy.pages > 1 %>
  </div>
<% else %>
  <div class="alert alert-warning text-center" role="alert">
    <%= t "departments.index.table.no_result" %>
  </div>
<% end %>
